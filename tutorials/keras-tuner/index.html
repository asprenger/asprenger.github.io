
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Keras Tuner Tutorial</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid="0"
                  id="24242"
                  title="Keras Tuner Tutorial"
                  environment="web"
                  feedback-link="github.com/mariopce">
    
      <google-codelab-step label="Overview of the tutorial" duration="1">
        

      </google-codelab-step>
    
      <google-codelab-step label="Setup" duration="1">
        <p>Install TensorFlow 2.0 beta:</p>
<pre><code>pip install tensorflow==2.0.0b1
</code></pre>
<p>Install Keras Tuner:</p>
<pre><code>git clone https://github.com/keras-team/keras-tuner.git
cd keras-tuner
pip install .
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Add parameter samplers" duration="0">
        <pre><code>def build_tunable_model(hp):
    # hp is an instance of kerastuner.engine.hyperparameters.HyperParameters
    params = {
      &#39;nb_conv1_filters&#39;: 32,
      &#39;nb_conv2_filters&#39;: 64,
      &#39;nb_hidden&#39;: 128,
      &#39;drop_rate&#39;: hp.Linear(&#39;drop_rate&#39;, min_value=0.1, 
                             max_value=0.3, resolution=0.02),
      &#39;learning_rate&#39;: hp.Choice(&#39;learning_rate&#39;, 
                                 values=[1e-2, 1e-3, 1e-4])
    }
    return build_model(params)
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Define a search strategy" duration="0">
        <pre><code>tuner = RandomSearch(
    build_model,
    objective=&#39;val_accuracy&#39;,
    max_trials=3,
    executions_per_trial=1,
    directory=&#39;/tmp/keras_runs&#39;,
    project_name=&#39;mnist_keras_tuned&#39;)

</code></pre>
<p>Print a summary of the search space with <code>tuner.search_space_summary()</code>:</p>
<pre><code>[Search space summary]
 |-Default search space size: 2
 &gt; drop_rate (Linear)
 |-default: 0.1
 |-max_value: 0.3
 |-min_value: 0.1
 |-resolution: 0.01
 &gt; learning_rate (Choice)
 |-default: 0.01
 |-values: [0.01, 0.001, 0.0001]
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Train the model with different parameters" duration="0">
        <p><code>tuner.search()</code> has the same signature as <code>model.fit()</code>.</p>
<pre><code>tuner.search(x_train, y_train,
          batch_size=batch_size,
          epochs=epochs,
          verbose=1,
          validation_data=(x_test, y_test))

</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Print a summary of the results" duration="0">
        <p>Print a summary of the search space with <code>tuner.results_summary()</code>:</p>
<pre><code>[Results summary]
 |-Results in /tmp/keras_runs/mnist_keras_tuned
 |-Ran 10 trials
 |-Ran 10 executions (1 per trial)
 |-Best val_accuracy: 0.9909
Best parameters: {&#39;drop_rate&#39;: 0.14, &#39;learning_rate&#39;: 0.001}
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Output directory" duration="0">
        <p>The output directory looks like this:</p>
<pre><code>./tuner.json
./oracle.json
./best_model.h5
./trial_63ab700d10a28626d56e7e64116184f5/trial.json
./trial_63ab700d10a28626d56e7e64116184f5/execution_0/execution.json
./trial_63ab700d10a28626d56e7e64116184f5/execution_0/63ab700d10a28626d56e7e64116184f5-0-weights.h5
./trial_63ab700d10a28626d56e7e64116184f5/execution_0/63ab700d10a28626d56e7e64116184f5-0-config.json
./trial_42a50a5210e8266804e8f866352395fe/trial.json
./trial_42a50a5210e8266804e8f866352395fe/execution_0/execution.json
./trial_42a50a5210e8266804e8f866352395fe/execution_0/42a50a5210e8266804e8f866352395fe-0-config.json
./trial_42a50a5210e8266804e8f866352395fe/execution_0/42a50a5210e8266804e8f866352395fe-0-weights.h5
...
</code></pre>
<ul>
<li>tuner.json</li>
<li>oracle.json</li>
<li>train.json (one for each trail)</li>
<li>execution.json (one for each execution)</li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
